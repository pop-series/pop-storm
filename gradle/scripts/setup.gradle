allprojects {
    task install {}
}

task installGitHooks {
    doLast {
        def gitHooksSourcePath = "${rootDir}/git_hooks"
        def gitHooksTargetPath = "${rootDir}/.git/hooks"
        fileTree(gitHooksSourcePath).filter {
            it.isFile() && it.getName().endsWith(".sh")
        }.files.name.forEach { fileName ->
            exec {
                commandLine "ln", "-sf", "${gitHooksSourcePath}/${fileName}", "${gitHooksTargetPath}/${fileName.take(fileName.size() - 3)}"
            }
        }
    }
}

install {
    dependsOn("${project.path}:installGitHooks")
}
